<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<html lang="el" style="height:100%">
	<head>

			<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
			<meta http-equiv="X-UA-Compatible" content="IE=edge">
			<meta name="viewport" content="width=device-width, initial-scale=1">
			<title>Ηλεκτρονικές Υπηρεσίες Εγγράφων</title>
		
				<!-- Bootstrap core CSS 
			<link rel="stylesheet" type="text/css" href="/libraries/fontawesome-free-5.15.4-web/css/all.css" />-->
			
			<link rel="icon" type="image/png" href="/directorSign/css/images/server4.png">
			<link rel="stylesheet" type="text/css" href="css/custom.css" />
			<link rel="stylesheet" type="text/css" href="/libraries/fontawesome-free-5.15.4-web/css/all.css" >
			
			<script type="module">
					import runFetch from "./modules/CustomFetch.js";
					import Keycloak from './node_modules/keycloak-js/lib/keycloak.js'
					
					const LOGS = {APACHE : 0, PHP : 1, LIQUIBASE : 2}

					
					const defaultSettings = {
						'#header@background-color': "#99614d",
						'#topMenu@background-color' : "#99614d",
						'.protocol@background-color':"#f5f5dc",
						'.report@background-color':"#90ee90",
						'.report@display':"none",
						'body@background-color':"#ffffff",
						'body@color':"#000000"
					}

					
					const keycloak = new Keycloak({
						url: "https://10.142.49.91:8443/",
						realm: "pde",
						clientId: "public-client"
					});

					try {
						keycloak.init({onLoad: 'login-required'}).then((authenticated) => {
							if (authenticated) {
								const token = keycloak.token;
								const tokenParsed = keycloak.tokenParsed;
								loginDataObject ={};
								loginDataObject.jwt = keycloak.token;
								loginDataObject.user = {};
								loginDataObject.user.user = keycloak.tokenParsed.name;
								loginDataObject.user.signatureSch = keycloak.tokenParsed.name??"";

								const settingFromStorage = JSON.parse(localStorage.getItem("settings")) ?? defaultSettings;
								localStorage.clear();
								localStorage.setItem("settings", JSON.stringify(settingFromStorage));
								//const loginData = await res.json();
								localStorage.setItem("loginData", JSON.stringify(result.loginData));
								//console.log(JSON.parse(localStorage.getItem("loginData")));
								localStorage.setItem("currentRole",0);
								location.href= "signatures_test.html";
								localStorage.removeItem('filter');
							}
						})
					} catch (error) {
						console.error('Failed to initialize adapter:', error);
					}		

			</script>


		
	</head>
	
	<body style="font-family: roboto; ">
		<div id="containerDiv" style="display:flex; flex-direction: column;align-items: center;padding-top: 3em;">
			<div id="loginDiv" style="box-shadow: 0.5em 0.5em rgba(255,215,0,0.5); border-style:solid; background-color: white; display:flex; flex-direction: column; gap: 10px; width: 450px;padding: 2em; border-radius : 10px; color: black">
				<div id="logoContainer"  style="display:flex; justify-content: center; margin-bottom:60px; margin-top:20px; gap:10px; align-items:center;">
					<div><img src="css/images/aianiHorseEdge3.png" alt="logoimage" style="width:60px; "></div>
					<div><label class="titlos">Αιανός</label></div>
					<div><i id="logDialogBtn" class="fab fa-docker fa-2x" style="cursor: pointer;"></i></div>
				</div >
			</div>
			<div  style="display:flex; flex-wrap: wrap; margin-top : 3em; width: 80%; justify-content: center;" id="nameList"></div>
			<div id="bottomSection" style="margin-top:4em;"></div>
		</div>

	</body>
</html>